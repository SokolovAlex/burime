{"ast":null,"code":"import _Object$defineProperty from \"@babel/runtime-corejs2/core-js/object/define-property\";\nimport _Object$defineProperties from \"@babel/runtime-corejs2/core-js/object/define-properties\";\nimport _Object$getOwnPropertyDescriptors from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptors\";\nimport _Object$getOwnPropertyDescriptor from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptor\";\nimport _Object$getOwnPropertySymbols from \"@babel/runtime-corejs2/core-js/object/get-own-property-symbols\";\nimport _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _extends from \"@babel/runtime-corejs2/helpers/esm/extends\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nvar _jsxFileName = \"C:\\\\Users\\\\alexs\\\\Desktop\\\\\\u0410\\u043B\\u0435\\u043A\\u0441\\u0435\\u0439\\\\code\\\\burime\\\\client\\\\pages\\\\_app.tsx\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = _Object$keys(object); if (_Object$getOwnPropertySymbols) { var symbols = _Object$getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return _Object$getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (_Object$getOwnPropertyDescriptors) { _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React from 'react';\nimport NextApp from 'next/app';\nimport nCookies from 'next-cookies';\nimport { status } from '../services/api/auth';\nimport { UserContext } from '../services/contexts/auth';\n\nvar App =\n/*#__PURE__*/\nfunction (_NextApp) {\n  _inherits(App, _NextApp);\n\n  function App(props) {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(App).call(this, props));\n\n    _initialiseProps.call(_assertThisInitialized(_this));\n\n    var user = _this.props.pageProps.user;\n    _this.state = {\n      user: user\n    };\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var jssStyles = document.querySelector('#jss-server-side');\n      if (jssStyles && jssStyles.parentNode) jssStyles.parentNode.removeChild(jssStyles);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props = this.props,\n          Component = _this$props.Component,\n          pageProps = _this$props.pageProps;\n      var logged = pageProps.logged;\n      return React.createElement(UserContext.Provider, {\n        value: {\n          user: this.state.user,\n          logged: logged,\n          setUser: function setUser(user) {\n            return _this2.setUser(user);\n          }\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 45\n        },\n        __self: this\n      }, React.createElement(Component, _extends({}, pageProps, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 52\n        },\n        __self: this\n      })));\n    }\n  }], [{\n    key: \"getInitialProps\",\n    value: function getInitialProps(_ref) {\n      var Component, ctx, pageProps, cookies, statusResult, _statusResult, user, logged;\n\n      return _regeneratorRuntime.async(function getInitialProps$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              Component = _ref.Component, ctx = _ref.ctx;\n              pageProps = {};\n\n              if (!Component.getInitialProps) {\n                _context.next = 6;\n                break;\n              }\n\n              _context.next = 5;\n              return _regeneratorRuntime.awrap(Component.getInitialProps(ctx));\n\n            case 5:\n              pageProps = _context.sent;\n\n            case 6:\n              cookies = nCookies(ctx);\n              _context.prev = 7;\n              _context.next = 10;\n              return _regeneratorRuntime.awrap(status(cookies));\n\n            case 10:\n              statusResult = _context.sent;\n              _context.next = 16;\n              break;\n\n            case 13:\n              _context.prev = 13;\n              _context.t0 = _context[\"catch\"](7);\n              statusResult = {};\n\n            case 16:\n              _statusResult = statusResult, user = _statusResult.user, logged = _statusResult.logged;\n              return _context.abrupt(\"return\", {\n                pageProps: _objectSpread({}, pageProps, {\n                  user: user,\n                  logged: logged\n                })\n              });\n\n            case 18:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, [[7, 13]]);\n    }\n  }]);\n\n  return App;\n}(NextApp);\n\nvar _initialiseProps = function _initialiseProps() {\n  var _this3 = this;\n\n  this.setUser = function (user) {\n    _this3.setState({\n      user: user\n    });\n  };\n};\n\nexport { App as default };","map":{"version":3,"sources":["C:/Users/alexs/Desktop/Алексей/code/burime/client/pages/_app.tsx"],"names":["React","NextApp","nCookies","status","UserContext","App","props","user","pageProps","state","jssStyles","document","querySelector","parentNode","removeChild","Component","logged","setUser","ctx","getInitialProps","cookies","statusResult","setState"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,OAAP,MAAoB,UAApB;AACA,OAAOC,QAAP,MAAqB,cAArB;AACA,SAASC,MAAT,QAAuB,sBAAvB;AACA,SAASC,WAAT,QAA4B,2BAA5B;;IAGqBC,G;;;;;AACjB,eAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACf,6EAAMA,KAAN;;AADe;;AAAA,QAEMC,IAFN,GAEiB,MAAKD,KAFtB,CAEPE,SAFO,CAEMD,IAFN;AAGf,UAAKE,KAAL,GAAa;AAAEF,MAAAA,IAAI,EAAJA;AAAF,KAAb;AAHe;AAIlB;;;;wCAkBmB;AAChB,UAAMG,SAAS,GAAGC,QAAQ,CAACC,aAAT,CAAuB,kBAAvB,CAAlB;AACA,UAAIF,SAAS,IAAIA,SAAS,CAACG,UAA3B,EACIH,SAAS,CAACG,UAAV,CAAqBC,WAArB,CAAiCJ,SAAjC;AACP;;;6BAMQ;AAAA;;AAAA,wBAC4B,KAAKJ,KADjC;AAAA,UACGS,SADH,eACGA,SADH;AAAA,UACcP,SADd,eACcA,SADd;AAAA,UAEGQ,MAFH,GAEcR,SAFd,CAEGQ,MAFH;AAGL,aACI,oBAAC,WAAD,CAAa,QAAb;AACI,QAAA,KAAK,EAAE;AACHT,UAAAA,IAAI,EAAE,KAAKE,KAAL,CAAWF,IADd;AAEHS,UAAAA,MAAM,EAANA,MAFG;AAGHC,UAAAA,OAAO,EAAE,iBAACV,IAAD;AAAA,mBAAqB,MAAI,CAACU,OAAL,CAAaV,IAAb,CAArB;AAAA;AAHN,SADX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAOI,oBAAC,SAAD,eAAeC,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAPJ,CADJ;AAWH;;;;;;;;;;AAxC8BO,cAAAA,S,QAAAA,S,EAAWG,G,QAAAA,G;AAClCV,cAAAA,S,GAAiB,E;;mBACjBO,SAAS,CAACI,e;;;;;;+CACQJ,SAAS,CAACI,eAAV,CAA0BD,GAA1B,C;;;AAAlBV,cAAAA,S;;;AAEEY,cAAAA,O,GAAUlB,QAAQ,CAACgB,GAAD,C;;;+CAGCf,MAAM,CAACiB,OAAD,C;;;AAA3BC,cAAAA,Y;;;;;;;AAEAA,cAAAA,YAAY,GAAG,EAAf;;;8BAEqBA,Y,EAAjBd,I,iBAAAA,I,EAAMS,M,iBAAAA,M;+CACP;AAAER,gBAAAA,SAAS,oBAAOA,SAAP;AAAkBD,kBAAAA,IAAI,EAAJA,IAAlB;AAAwBS,kBAAAA,MAAM,EAANA;AAAxB;AAAX,e;;;;;;;;;;;;EApBkBf,O;;;;;OA6B7BgB,O,GAAU,UAACV,IAAD,EAAqB;AAC3B,IAAA,MAAI,CAACe,QAAL,CAAc;AAAEf,MAAAA,IAAI,EAAJA;AAAF,KAAd;AACH,G;;;SA/BgBF,G","sourcesContent":["import React from 'react';\nimport NextApp from 'next/app';\nimport nCookies from 'next-cookies';\nimport { status } from '../services/api/auth';\nimport { UserContext } from '../services/contexts/auth';\nimport { UserModel } from '../models/user';\n\nexport default class App extends NextApp<{}, {}, { user: UserModel }> {\n    constructor(props) {\n        super(props);\n        const { pageProps: { user } } = this.props;\n        this.state = { user };\n    }\n\n    static async getInitialProps({ Component, ctx }) {\n        let pageProps: any = {};\n        if (Component.getInitialProps) {\n            pageProps = await Component.getInitialProps(ctx);\n        }\n        const cookies = nCookies(ctx);\n        let statusResult;\n        try{\n            statusResult = await status(cookies);\n        } catch {\n            statusResult = {};\n        }\n        const { user, logged } = statusResult;\n        return { pageProps: { ...pageProps, user, logged } };\n    }\n\n    componentDidMount() {\n        const jssStyles = document.querySelector('#jss-server-side');\n        if (jssStyles && jssStyles.parentNode)\n            jssStyles.parentNode.removeChild(jssStyles);\n    }\n\n    setUser = (user: UserModel) => {\n        this.setState({ user });\n    };\n\n    render() {\n        const { Component, pageProps } = this.props;\n        const { logged } = pageProps;\n        return (\n            <UserContext.Provider\n                value={{\n                    user: this.state.user,\n                    logged,\n                    setUser: (user: UserModel) => this.setUser(user),\n                }}\n            >\n                <Component {...pageProps} />\n            </UserContext.Provider>\n        );\n    }\n}\n"]},"metadata":{},"sourceType":"module"}