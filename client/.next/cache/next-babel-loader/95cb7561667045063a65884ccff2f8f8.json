{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport { getCommonMessage, changeActiveUsers } from './../../constants/socketEvents';\nimport { useState, useEffect } from 'react';\nimport { getApi } from './api';\nvar api = getApi();\nexport var getCommonMessages = function getCommonMessages() {\n  return api.get('/api/common-chat-messages').then(function (response) {\n    return response.data;\n  });\n};\nexport var useMessages = function useMessages(email, socket) {\n  var _useState = useState(true),\n      loading = _useState[0],\n      setLoading = _useState[1];\n\n  var _useState2 = useState(null),\n      error = _useState2[0],\n      setError = _useState2[1];\n\n  var _useState3 = useState([]),\n      messages = _useState3[0],\n      setMessages = _useState3[1];\n\n  var _useState4 = useState(0),\n      activeUsers = _useState4[0],\n      setActiveUsers = _useState4[1];\n\n  useEffect(function () {\n    getCommonMessages().then(function (data) {\n      var messages = data.messages.map(function (message) {\n        message.isMine = message.author.email === email;\n        return message;\n      });\n      setActiveUsers(data.activeUsers);\n      setMessages(messages);\n    })[\"catch\"](function (err) {\n      return setError(err);\n    })[\"finally\"](function () {\n      return setLoading(false);\n    });\n\n    var onChangeActiveUsers = function onChangeActiveUsers(activeUsers) {\n      return setActiveUsers(activeUsers);\n    };\n\n    socket.on(changeActiveUsers, onChangeActiveUsers);\n    return function () {\n      socket.off(changeActiveUsers, onChangeActiveUsers);\n    };\n  }, []);\n  useEffect(function () {\n    var onGetMessage = function onGetMessage(message) {\n      message.isMine = message.author.email === email;\n      setMessages([].concat(_toConsumableArray(messages), [message]));\n    };\n\n    socket.on(getCommonMessage, onGetMessage);\n    return function () {\n      socket.off(getCommonMessage, onGetMessage);\n    };\n  }, [messages]);\n  return {\n    loading: loading,\n    messages: messages,\n    error: error,\n    activeUsers: activeUsers\n  };\n};","map":null,"metadata":{},"sourceType":"module"}