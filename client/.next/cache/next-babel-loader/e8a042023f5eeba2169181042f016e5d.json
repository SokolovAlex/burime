{"ast":null,"code":"import { BurimeStatus } from '../../models/burime';\nimport { useState, useEffect } from 'react';\nimport { getApi } from './api';\nimport Router from 'next/router';\nvar api = getApi();\nvar callsUrl = '/api/calls';\nvar burimeUrl = '/api/burime';\nvar myBurimeUrl = '/api/burime/my';\nvar allBurimeUrl = '/api/burime/all';\nvar randomTitleUrl = '/api/burime/random-title';\nexport var getBurimes = function getBurimes(url, params) {\n  return api.get(url, {\n    params: params\n  }).then(function (response) {\n    return response.data;\n  });\n};\nexport var getBurime = function getBurime(id) {\n  return api.get(\"\".concat(burimeUrl, \"/\").concat(id)).then(function (response) {\n    return response.data;\n  });\n};\nexport var getFinishedBurime = function getFinishedBurime(id) {\n  return api.get(\"\".concat(burimeUrl, \"/\").concat(id), {\n    params: {\n      status: BurimeStatus.Finish\n    }\n  }).then(function (response) {\n    return response.data;\n  });\n};\nexport var getCalls = function getCalls() {\n  return api.get('/api/calls').then(function (response) {\n    return response.data;\n  });\n};\nexport var getActiveGame = function getActiveGame() {\n  return api.get('/api/burime/active').then(function (response) {\n    return response.data;\n  });\n};\nexport var getUserGames = function getUserGames() {\n  return api.get('/api/burime/user-games').then(function (response) {\n    return response.data;\n  });\n};\nexport var useBurime = function useBurime(url) {\n  var _useState = useState(true),\n      loading = _useState[0],\n      setLoading = _useState[1];\n\n  var _useState2 = useState(null),\n      error = _useState2[0],\n      setError = _useState2[1];\n\n  var _useState3 = useState([]),\n      burimes = _useState3[0],\n      setBurimes = _useState3[1];\n\n  useEffect(function () {\n    getBurimes(url).then(function (data) {\n      return setBurimes(data.burimes);\n    })[\"catch\"](function (err) {\n      return setError(err);\n    })[\"finally\"](function () {\n      return setLoading(false);\n    });\n  }, []);\n  return {\n    loading: loading,\n    burimes: burimes,\n    error: error,\n    setBurimes: setBurimes\n  };\n};\nexport var useGame = function useGame(id, user) {\n  var _useState4 = useState(true),\n      loading = _useState4[0],\n      setLoading = _useState4[1];\n\n  var _useState5 = useState(),\n      error = _useState5[0],\n      setError = _useState5[1];\n\n  var _useState6 = useState(),\n      burime = _useState6[0],\n      setBurime = _useState6[1];\n\n  useEffect(function () {\n    getBurime(id).then(function (data) {\n      var burime = data.burime;\n\n      if (!user) {\n        setError(\"plese enter\");\n        return;\n      }\n\n      if (!burime) {\n        setError(\"No burime with id: \".concat(id));\n        return;\n      }\n\n      if (burime.user1.email !== user.email && burime.user2.email !== user.email) {\n        setError(\"not you game\");\n        return;\n      }\n\n      setBurime(data.burime);\n    })[\"catch\"](function (err) {\n      return setError(err);\n    })[\"finally\"](function () {\n      return setLoading(false);\n    });\n  }, []);\n  return {\n    loading: loading,\n    burime: burime,\n    error: error\n  };\n};\nexport var useFinishedBurime = function useFinishedBurime(id) {\n  var _useState7 = useState(true),\n      loading = _useState7[0],\n      setLoading = _useState7[1];\n\n  var _useState8 = useState(),\n      error = _useState8[0],\n      setError = _useState8[1];\n\n  var _useState9 = useState(),\n      burime = _useState9[0],\n      setBurime = _useState9[1];\n\n  useEffect(function () {\n    getFinishedBurime(id).then(function (data) {\n      var burime = data.burime;\n\n      if (!burime) {\n        setError(\"No burime with id: \".concat(id));\n        return;\n      }\n\n      setBurime(data.burime);\n    })[\"catch\"](function (err) {\n      return setError(err);\n    })[\"finally\"](function () {\n      return setLoading(false);\n    });\n  }, []);\n  return {\n    loading: loading,\n    burime: burime,\n    error: error\n  };\n};\nexport var useMyBurimes = function useMyBurimes() {\n  return useBurime(myBurimeUrl);\n};\nexport var useBurimesPage = function useBurimesPage(_ref) {\n  var page = _ref.page,\n      size = _ref.size;\n\n  var _useState10 = useState(true),\n      loading = _useState10[0],\n      setLoading = _useState10[1];\n\n  var _useState11 = useState(page),\n      pageNumber = _useState11[0],\n      setPage = _useState11[1];\n\n  var _useState12 = useState(size),\n      pageSize = _useState12[0],\n      setPageSize = _useState12[1];\n\n  var _useState13 = useState(null),\n      error = _useState13[0],\n      setError = _useState13[1];\n\n  var _useState14 = useState([]),\n      burimes = _useState14[0],\n      setBurimes = _useState14[1];\n\n  var _useState15 = useState(),\n      total = _useState15[0],\n      setTotal = _useState15[1];\n\n  useEffect(function () {\n    getBurimes(allBurimeUrl, {\n      page: pageNumber,\n      size: pageSize\n    }).then(function (data) {\n      setBurimes(data.burimes);\n      setTotal(data.total);\n    })[\"catch\"](function (err) {\n      return setError(err);\n    })[\"finally\"](function () {\n      return setLoading(false);\n    });\n  }, [pageNumber]);\n  return {\n    loading: loading,\n    burimes: burimes,\n    error: error,\n    total: total,\n    setPage: setPage,\n    setPageSize: setPageSize,\n    setBurimes: setBurimes\n  };\n};\nexport var useCheckFinishedBurime = function useCheckFinishedBurime(id) {\n  useEffect(function () {\n    getFinishedBurime(id).then(function (data) {\n      if (data.burime) {\n        goToBurime(id);\n      }\n    });\n  }, []);\n};\nexport var useActiveBurime = function useActiveBurime() {\n  useEffect(function () {\n    getActiveGame().then(function (data) {\n      if (data.burime) {\n        goToGame(data.burime.id);\n      }\n    });\n  }, []);\n};\nexport var getRandomTitle = function getRandomTitle() {\n  return api.get(randomTitleUrl).then(function (response) {\n    return response.data;\n  });\n};\nexport var useCalls = function useCalls() {\n  return useBurime(callsUrl);\n};\nexport var goToGame = function goToGame(burimeId) {\n  return Router.push(\"/game/\".concat(burimeId));\n};\nexport var goToBurime = function goToBurime(burimeId) {\n  return Router.push(\"/burime/\".concat(burimeId));\n};","map":null,"metadata":{},"sourceType":"module"}